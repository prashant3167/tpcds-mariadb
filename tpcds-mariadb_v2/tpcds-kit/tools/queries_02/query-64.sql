
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '18808','51142','23418','65150','30791','90907',
                          '21335','68760','15118','47452','52119',
                          '80844','18540','41775','37304','42192',
                          '90940','53287','89747','45209','91112',
                          '90557','98548','81584','34319','11164',
                          '38566','73611','92374','81473','33708',
                          '57965','16852','21680','51412','34688',
                          '11233','53026','12168','85627','23944',
                          '26270','64476','37072','24891','41109',
                          '81310','75321','22840','13051','19899',
                          '57756','44597','34595','27810','99372',
                          '36782','65785','23789','14127','60601',
                          '62149','10585','31547','22853','10216',
                          '33620','29138','74664','26596','29038',
                          '81251','11705','76372','93337','30583',
                          '50295','34838','13408','32162','92823',
                          '33583','11885','13083','14880','23010',
                          '50577','99258','64800','36389','82357',
                          '95700','33035','65005','92581','26261',
                          '16281','47631','19794','62546','56212',
                          '86292','68096','21917','44188','49664',
                          '14083','68992','59596','99371','13382',
                          '12642','93056','14667','11117','77888',
                          '40732','22044','11210','58569','75471',
                          '51677','30026','36247','32826','39153',
                          '52576','38947','36926','26459','75438',
                          '28831','70505','39418','83922','22065',
                          '36061','70769','56095','42392','10981',
                          '10373','15731','75332','47812','97907',
                          '74695','27000','85415','91065','17707',
                          '85432','35502','76631','32751','25462',
                          '99628','94750','60728','78080','89010',
                          '79236','66607','40726','90863','29774',
                          '90536','34909','44528','39221','41121',
                          '26922','51737','12091','85061','64197',
                          '78446','53548','74656','72798','92389',
                          '81612','37474','46495','28295','37843',
                          '35663','53056','12292','25077','21264',
                          '31784','48436','21599','27921','63287',
                          '29945','26709','41012','21696','27253',
                          '61335','28468','63616','57711','21341',
                          '35176','24865','32252','99456','70680',
                          '82204','25543','27494','45009','62720',
                          '52524','16929','50014','89836','12355',
                          '48249','76329','83883','48257','12809',
                          '39712','57700','61851','34098','99013',
                          '59887','47993','45601','37653','18923',
                          '59480','74690','80444','34562','75278',
                          '16640','43318','61256','26113','20576',
                          '30518','72268','87083','32551','90447',
                          '80080','27748','37417','79959','56523',
                          '71394','34168','27098','99654','35959',
                          '15898','65764','42548','37096','12215',
                          '54382','36216','88249','15957','71535',
                          '37981','58746','33950','77095','51520',
                          '10244','68065','86203','17911','44949',
                          '83492','53696','96819','98434','87963',
                          '89630','70185','26443','29084','93160',
                          '62565','58608','17885','54894','81069',
                          '91376','18598','89018','12859','38123',
                          '44309','30116','20238','74859','72139',
                          '19092','15966','39938','45698','46153',
                          '83053','71855','75208','84769','64831',
                          '66741','77756','22544','60769','34979',
                          '69996','20365','55823','55607','84181',
                          '36582','39471','29499','20545','52560',
                          '35401','32941','75289','44164','43784',
                          '28654','20328','27434','11003','80128',
                          '33374','61451','30011','61947','60963',
                          '46120','38759','30664','87347','30987',
                          '78646','83383','77034','71219','91175',
                          '18374','56925','25631','65877','55987',
                          '33232','24885','11094','25887','11260',
                          '65919','21342','45430','25904','32123',
                          '15869','31457','35985','10928','14787',
                          '25507','56322','45893','19751','26476',
                          '11343','11027','56135','91637','58964',
                          '51863','27089','57897','12446','31317',
                          '30391','86021','92260','32921','49375',
                          '15349','16210','16423','43473')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100
